"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./index-e050b855.js"),t=require("react"),i=require("react-dom/client");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=n(t);const o=({templates:t,components:i})=>{const n=e.useParams(),o=Object.values(n).join("-");return a.default.createElement(e.Page,{templates:t,components:i,key:o})};var r={exports:{}};self;var s=r.exports=(()=>{return e={36:function(e,t){var i,n;n="undefined"!=typeof window?window:this,i=function(){return function(e){if("undefined"!=typeof window){var t={SESSIONS:"sessions",EVENTS:"events",VIEWS:"views",SCROLLS:"scrolls",CLICKS:"clicks",FORMS:"forms",CRASHES:"crashes",ATTRIBUTION:"attribution",USERS:"users",STAR_RATING:"star-rating",LOCATION:"location",APM:"apm",FEEDBACK:"feedback",REMOTE_CONFIG:"remote-config"};(e=e||{}).features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG];var i={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",PUSH_ACTION:"[CLY]_push_action",ACTION:"[CLY]_action"},n={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},a={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2,URL_PROVIDED:3},o={BEAT_INTERVAL:500,QUEUE_SIZE:1e3,FAIL_TIMEOUT_AMOUNT:60,INACTIVITY_TIME:20,SESSION_UPDATE:60,MAX_EVENT_BATCH:100,SESSION_COOKIE_TIMEOUT:30,MAX_KEY_LENGTH:128,MAX_VALUE_SIZE:256,MAX_SEGMENTATION_VALUES:30,MAX_BREADCRUMB_COUNT:100,MAX_STACKTRACE_LINES_PER_THREAD:30,MAX_STACKTRACE_LINE_LENGTH:200};e.q=e.q||[],e.onload=e.onload||[];var r="22.06.1",s="javascript_native_web",c=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/;e.CountlyClass=function(d){var A,B=this,F=!e.i,P=!1,G="/i",W="/o/sdk",z=f("interval",d,o.BEAT_INTERVAL),V=f("queue_size",d,o.QUEUE_SIZE),M=[],H=[],q={},K=[],j={},Y=f("ignore_referrers",d,[]),J=null,X=!0,$=0,Q=null,Z=0,ee=0,te=0,ie=f("fail_timeout",d,o.FAIL_TIMEOUT_AMOUNT),ne=f("inactivity_time",d,o.INACTIVITY_TIME),ae=0,oe=f("session_update",d,o.SESSION_UPDATE),re=f("max_events",d,o.MAX_EVENT_BATCH),se=f("max_logs",d,null),ce=f("use_session_cookie",d,!0),de=f("session_cookie_timeout",d,o.SESSION_COOKIE_TIMEOUT),le=!0,ue=!1,ge=f("offline_mode",d,!1),pe={},me=!0,_e=_(),he=!0,fe=null,ye=a.SDK_GENERATED,ve=!1,Ee=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(e){Ge(n.ERROR,"Local storage test failed, Halting local storage support: "+e),he=!1}for(var we,ke={},be=0;be<e.features.length;be++)ke[e.features[be]]={};this.initialize=function(){if(this.serialize=f("serialize",d,e.serialize),this.deserialize=f("deserialize",d,e.deserialize),this.getViewName=f("getViewName",d,e.getViewName),this.getViewUrl=f("getViewUrl",d,e.getViewUrl),this.getSearchQuery=f("getSearchQuery",d,e.getSearchQuery),this.DeviceIdType=e.DeviceIdType,this.namespace=f("namespace",d,""),this.clearStoredId=f("clear_stored_id",d,!1),this.app_key=f("app_key",d,null),this.onload=f("onload",d,[]),this.utm=f("utm",d,{source:!0,medium:!0,campaign:!0,term:!0,content:!0}),this.ignore_prefetch=f("ignore_prefetch",d,!0),this.debug=f("debug",d,!1),this.test_mode=f("test_mode",d,!1),this.metrics=f("metrics",d,{}),this.headers=f("headers",d,{}),this.url=E(f("url",d,"")),this.app_version=f("app_version",d,"0.0"),this.country_code=f("country_code",d,null),this.city=f("city",d,null),this.ip_address=f("ip_address",d,null),this.ignore_bots=f("ignore_bots",d,!0),this.force_post=f("force_post",d,!1),this.remote_config=f("remote_config",d,!1),this.ignore_visitor=f("ignore_visitor",d,!1),this.require_consent=f("require_consent",d,!1),this.track_domains=f("track_domains",d,!0),this.storage=f("storage",d,"default"),this.enableOrientationTracking=f("enable_orientation_tracking",d,!0),this.maxKeyLength=f("max_key_length",d,o.MAX_KEY_LENGTH),this.maxValueSize=f("max_value_size",d,o.MAX_VALUE_SIZE),this.maxSegmentationValues=f("max_segmentation_values",d,o.MAX_SEGMENTATION_VALUES),this.maxBreadcrumbCount=f("max_breadcrumb_count",d,null),this.maxStackTraceLinesPerThread=f("max_stack_trace_lines_per_thread",d,o.MAX_STACKTRACE_LINES_PER_THREAD),this.maxStackTraceLineLength=f("max_stack_trace_line_length",d,o.MAX_STACKTRACE_LINE_LENGTH),se&&!this.maxBreadcrumbCount?(this.maxBreadcrumbCount=se,Ge(n.WARNING,"initialize, 'maxCrashLogs' is deprecated. Use 'maxBreadcrumbCount' instead!")):se||this.maxBreadcrumbCount||(this.maxBreadcrumbCount=100),"cookie"===this.storage&&(he=!1),Array.isArray(Y)||(Y=[]),""===this.url&&(Ge(n.ERROR,"initialize, Please provide server URL"),this.ignore_visitor=!0),je("cly_ignore")&&(this.ignore_visitor=!0),function(){if(je(B.namespace+"cly_id",!1,!0)){Ye("cly_id",je(B.namespace+"cly_id",!1,!0)),Ye("cly_id_type",je(B.namespace+"cly_id_type",!1,!0)),Ye("cly_event",je(B.namespace+"cly_event",!1,!0)),Ye("cly_session",je(B.namespace+"cly_session",!1,!0));var e=je(B.namespace+"cly_queue",!1,!0);Array.isArray(e)&&Ye("cly_queue",e=e.filter((function(e){return e.app_key===B.app_key}))),je(B.namespace+"cly_cmp_id",!1,!0)&&(Ye("cly_cmp_id",je(B.namespace+"cly_cmp_id",!1,!0)),Ye("cly_cmp_uid",je(B.namespace+"cly_cmp_uid",!1,!0))),je(B.namespace+"cly_ignore",!1,!0)&&Ye("cly_ignore",je(B.namespace+"cly_ignore",!1,!0)),Je("cly_id",!1,!0),Je("cly_id_type",!1,!0),Je("cly_event",!1,!0),Je("cly_session",!1,!0),Je("cly_queue",!1,!0),Je("cly_cmp_id",!1,!0),Je("cly_cmp_uid",!1,!0),Je("cly_ignore",!1,!0)}}(),this.clearStoredId&&(Ge(n.INFO,"initialize, Clearing the device ID storage"),localStorage.removeItem(this.app_key+"/cly_id"),localStorage.removeItem(this.app_key+"/cly_id_type")),M=je("cly_queue")||[],H=je("cly_event")||[],q=je("cly_remote_configs")||{},Ne(),window.name&&0===window.name.indexOf("cly:"))try{this.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(e){Ge(n.ERROR,"initialize, Could not parse name: "+window.name+", error: "+e)}else if(location.hash&&0===location.hash.indexOf("#cly:"))try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(e){Ge(n.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+e)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&F)&&this.passed_data.token&&this.passed_data.purpose&&(this.passed_data.token!==je("cly_old_token")&&(qe(this.passed_data.token),Ye("cly_old_token",this.passed_data.token)),this.passed_data.url=this.passed_data.url||this.url,"heatmap"===this.passed_data.purpose&&(this.ignore_visitor=!0,L(),T(this.passed_data.url+"/views/heatmap.js",U))),this.ignore_visitor)Ge(n.WARNING,"initialize, ignore_visitor:["+this.ignore_visitor+"], this user will not be tracked");else{Ge(n.DEBUG,"initialize, app_key:["+this.app_key+"], url:["+this.url+"]"),Ge(n.DEBUG,"initialize, device_id:["+f("device_id",d,void 0)+"]"),Ge(n.DEBUG,"initialize, require_consent is enabled:["+this.require_consent+"]");try{Ge(n.DEBUG,"initialize, metric override:["+JSON.stringify(this.metrics)+"]"),Ge(n.DEBUG,"initialize, header override:["+JSON.stringify(this.headers)+"]"),Ge(n.DEBUG,"initialize, number of onload callbacks provided:["+this.onload.length+"]"),Ge(n.DEBUG,"initialize, utm tags:["+JSON.stringify(this.utm)+"]"),Y&&Ge(n.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(Y)+"]")}catch(e){Ge(n.ERROR,"initialize, Could not stringify some config object values")}Ge(n.DEBUG,"initialize, app_version:["+this.app_version+"]"),Ge(n.DEBUG,"initialize, provided location info; country_code:["+this.country_code+"], city:["+this.city+"], ip_address:["+this.ip_address+"]"),""!==this.namespace&&Ge(n.DEBUG,"initialize, namespace given:["+this.namespace+"]"),this.clearStoredId&&Ge(n.DEBUG,"initialize, clearStoredId flag set to:["+this.clearStoredId+"]"),this.ignore_prefetch&&Ge(n.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+this.ignore_prefetch+"]"),this.test_mode&&Ge(n.WARNING,"initialize, test_mode:["+this.test_mode+"], queues won't be processed"),"default"!==this.storage&&Ge(n.DEBUG,"initialize, storage is set to:["+this.storage+"]"),this.ignore_bots&&Ge(n.DEBUG,"initialize, ignore traffic from bots :["+this.ignore_bots+"]"),this.force_post&&Ge(n.DEBUG,"initialize, forced post method for all requests:["+this.force_post+"]"),this.remote_config&&Ge(n.DEBUG,"initialize, remote_config callback provided:["+!!this.remote_config+"]"),this.track_domains&&Ge(n.DEBUG,"initialize, tracking domain info:["+this.track_domains+"]"),this.enableOrientationTracking&&Ge(n.DEBUG,"initialize, enableOrientationTracking:["+this.enableOrientationTracking+"]"),ce||Ge(n.WARNING,"initialize, use_session_cookie is enabled:["+ce+"]"),ge&&Ge(n.DEBUG,"initialize, offline_mode:["+ge+"], user info won't be send to the servers"),Ge(n.DEBUG,"initialize, 'getViewName' callback override provided:["+!!this.getViewName+"]"),Ge(n.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+!!this.getSearchQuery+"]"),this.maxKeyLength!==o.MAX_KEY_LENGTH&&Ge(n.DEBUG,"initialize, maxKeyLength set to:["+this.maxKeyLength+"] characters"),this.maxValueSize!==o.MAX_VALUE_SIZE&&Ge(n.DEBUG,"initialize, maxValueSize set to:["+this.maxValueSize+"] characters"),this.maxSegmentationValues!==o.MAX_SEGMENTATION_VALUES&&Ge(n.DEBUG,"initialize, maxSegmentationValues set to:["+this.maxSegmentationValues+"] key/value pairs"),this.maxBreadcrumbCount!==o.MAX_BREADCRUMB_COUNT&&Ge(n.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+this.maxBreadcrumbCount+"] entries"),this.maxStackTraceLinesPerThread!==o.MAX_STACKTRACE_LINES_PER_THREAD&&Ge(n.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+this.maxStackTraceLinesPerThread+"] lines"),this.maxStackTraceLineLength!==o.MAX_STACKTRACE_LINE_LENGTH&&Ge(n.DEBUG,"initialize, maxStackTraceLineLength set to:["+this.maxStackTraceLineLength+"] characters"),z!==o.BEAT_INTERVAL&&Ge(n.DEBUG,"initialize, interval for heartbeats set to:["+z+"] milliseconds"),V!==o.QUEUE_SIZE&&Ge(n.DEBUG,"initialize, queue_size set to:["+V+"] items max"),ie!==o.FAIL_TIMEOUT_AMOUNT&&Ge(n.DEBUG,"initialize, fail_timeout set to:["+ie+"] seconds of wait time after a failed connection to server"),ne!==o.INACTIVITY_TIME&&Ge(n.DEBUG,"initialize, inactivity_time set to:["+ne+"] minutes to consider a user as inactive after no observable action"),oe!==o.SESSION_UPDATE&&Ge(n.DEBUG,"initialize, session_update set to:["+oe+"] seconds to check if extending a session is needed while the user is active"),re!==o.MAX_EVENT_BATCH&&Ge(n.DEBUG,"initialize, max_events set to:["+re+"] events to send in one batch"),se&&Ge(n.WARNING,"initialize, max_logs set to:["+se+"] breadcrumbs to store for crash logs max, deprecated "),de!==o.SESSION_COOKIE_TIMEOUT&&Ge(n.DEBUG,"initialize, session_cookie_timeout set to:["+de+"] minutes to expire a cookies session"),Ge(n.INFO,"initialize, Countly initialized");var t=null,i=B.getSearchQuery(),r=!1,s={};if(i)for(var c=i.substring(1).split("&"),l=0;l<c.length;l++){var u=c[l].split("=");"cly_id"===u[0]?Ye("cly_cmp_id",u[1]):"cly_uid"===u[0]?Ye("cly_cmp_uid",u[1]):"cly_device_id"===u[0]?t=u[1]:0===(u[0]+"").indexOf("utm_")&&this.utm[u[0].replace("utm_","")]&&(s[u[0].replace("utm_","")]=u[1],r=!0)}var g="[CLY]_temp_id"===je("cly_id"),p=f("device_id",d,void 0);if(je("cly_id")&&!g?(this.device_id=je("cly_id"),Ge(n.INFO,"initialize, Set the stored device ID"),(ye=je("cly_id_type"))||(Ge(n.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),ye=a.DEVELOPER_SUPPLIED)):null!==t?(Ge(n.INFO,"initialize, Device ID set by URL"),this.device_id=t,ye=a.URL_PROVIDED):p?(Ge(n.INFO,"initialize, Device ID set by developer"),this.device_id=p,d&&Object.keys(d).length?void 0!==d.device_id&&(ye=a.DEVELOPER_SUPPLIED):void 0!==e.device_id&&(ye=a.DEVELOPER_SUPPLIED)):ge||g?(this.device_id="[CLY]_temp_id",ye=a.TEMPORARY_ID,ge&&g?Ge(n.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):ge&&!g?Ge(n.INFO,"initialize, Temp ID set, entering offline mode"):(ge=!0,Ge(n.INFO,"initialize, Temp ID set, enabling offline mode"))):(Ge(n.INFO,"initialize, Generating the device ID"),this.device_id=f("device_id",d,Fe()),d&&Object.keys(d).length?void 0!==d.device_id&&(ye=a.DEVELOPER_SUPPLIED):void 0!==e.device_id&&(ye=a.DEVELOPER_SUPPLIED)),Ye("cly_id",this.device_id),Ye("cly_id_type",ye),r){for(var m in this.utm)s[m]?this.userData.set("utm_"+m,s[m]):this.userData.unset("utm_"+m);this.userData.save()}Ae(),setTimeout((function(){Be(),B.remote_config&&B.fetch_remote_config(B.remote_config)}),1),document.documentElement.setAttribute("data-countly-useragent",R())}},this.halt=function(){Ge(n.WARNING,"halt, Resetting Countly"),e.i=void 0,F=!e.i,P=!1,G="/i",W="/o/sdk",z=500,V=1e3,M=[],H=[],q={},K=[],j={},Y=[],J=null,X=!0,$=0,Q=null,Z=0,ee=0,te=0,ie=60,ne=20,ae=0,oe=60,re=100,se=null,ce=!0,de=30,le=!0,ue=!1,ge=!1,pe={},me=!0,_e=_(),he=!0,fe=null,ye=a.SDK_GENERATED,ve=!1,Ee=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(e){Ge(n.ERROR,"halt, Local storage test failed, will fallback to cookies"),he=!1}e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG],ke={};for(var i=0;i<e.features.length;i++)ke[e.features[i]]={};B.app_key=void 0,B.device_id=void 0,B.onload=void 0,B.utm=void 0,B.ignore_prefetch=void 0,B.debug=void 0,B.test_mode=void 0,B.metrics=void 0,B.headers=void 0,B.url=void 0,B.app_version=void 0,B.country_code=void 0,B.city=void 0,B.ip_address=void 0,B.ignore_bots=void 0,B.force_post=void 0,B.remote_config=void 0,B.ignore_visitor=void 0,B.require_consent=void 0,B.track_domains=void 0,B.storage=void 0,B.enableOrientationTracking=void 0,B.maxKeyLength=void 0,B.maxValueSize=void 0,B.maxSegmentationValues=void 0,B.maxBreadcrumbCount=void 0,B.maxStackTraceLinesPerThread=void 0,B.maxStackTraceLineLength=void 0},this.group_features=function(e){if(Ge(n.INFO,"group_features, Grouping features"),e)for(var t in e)ke[t]?Ge(n.WARNING,"group_features, Feature name ["+t+"] is already reserved"):"string"==typeof e[t]?ke[t]={features:[e[t]]}:e[t]&&Array.isArray(e[t])&&e[t].length?ke[t]={features:e[t]}:Ge(n.ERROR,"group_features, Incorrect feature list for ["+t+"] value: ["+e[t]+"]");else Ge(n.ERROR,"group_features, Incorrect features:["+e+"]")},this.check_consent=function(e){return Ge(n.INFO,"check_consent, Checking if consent is given for specific feature:["+e+"]"),this.require_consent?ke[e]?!(!ke[e]||!ke[e].optin):(Ge(n.ERROR,"check_consent, No feature available for ["+e+"]"),!1):(Ge(n.INFO,"check_consent, require_consent is off, no consent is necessary"),!0)},this.get_device_id_type=function(){var e;switch(Ge(n.INFO,"check_device_id_type, Retrieving the current device id type.["+ye+"]"),ye){case a.SDK_GENERATED:e=B.DeviceIdType.SDK_GENERATED;break;case a.URL_PROVIDED:case a.DEVELOPER_SUPPLIED:e=B.DeviceIdType.DEVELOPER_SUPPLIED;break;case a.TEMPORARY_ID:e=B.DeviceIdType.TEMPORARY_ID;break;default:e=-1}return e},this.get_device_id=function(){return Ge(n.INFO,"get_device_id, Retrieving the device id: ["+this.device_id+"]"),this.device_id},this.check_any_consent=function(){if(Ge(n.INFO,"check_any_consent, Checking if any consent is given"),!this.require_consent)return Ge(n.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var e in ke)if(ke[e]&&ke[e].optin)return!0;return Ge(n.INFO,"check_any_consent, No consents given"),!1},this.add_consent=function(e){if(Ge(n.INFO,"add_consent, Adding consent for ["+e+"]"),Array.isArray(e))for(var i=0;i<e.length;i++)this.add_consent(e[i]);else ke[e]?ke[e].features?(ke[e].optin=!0,this.add_consent(ke[e].features)):!0!==ke[e].optin&&(ke[e].optin=!0,Re(),setTimeout((function(){e===t.SESSIONS&&pe.begin_session?(B.begin_session.apply(B,pe.begin_session),pe.begin_session=null):e===t.VIEWS&&pe.track_pageview&&(Q=null,B.track_pageview.apply(B,pe.track_pageview),pe.track_pageview=null)}),1)):Ge(n.ERROR,"add_consent, No feature available for ["+e+"]")},this.remove_consent=function(e){Ge(n.INFO,"remove_consent, Removing consent for ["+e+"]"),this.remove_consent_internal(e,!0)},this.remove_consent_internal=function(e,t){if(t=t||!1,Array.isArray(e))for(var i=0;i<e.length;i++)this.remove_consent_internal(e[i],t);else ke[e]?ke[e].features?this.remove_consent_internal(ke[e].features,t):(ke[e].optin=!1,t&&!1!==ke[e].optin&&Re()):Ge(n.ERROR,"remove_consent, No feature available for ["+e+"]")};var Re=function(){we&&(clearTimeout(we),we=null),we=setTimeout((function(){for(var t={},i=0;i<e.features.length;i++)!0===ke[e.features[i]].optin?t[e.features[i]]=!0:t[e.features[i]]=!1;Ue({consent:JSON.stringify(t)}),Ge(n.DEBUG,"Consent update request has been sent to the queue.")}),1e3)};function Se(e){if(B.ignore_visitor)Ge(n.ERROR,"Adding event failed. Possible bot or user opt out");else if(e.key){e.count||(e.count=1),e.key=b(e.key,B.maxKeyLength,"add_cly_event",Ge),e.segmentation=k(e.segmentation,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"add_cly_event",Ge);var t=w(e,["key","count","sum","dur","segmentation"]);t.timestamp=h();var i=new Date;t.hour=i.getHours(),t.dow=i.getDay(),H.push(t),Ye("cly_event",H),Ge(n.INFO,"Successfully adding event: ",e)}else Ge(n.ERROR,"Adding event failed. Event must have a key property")}this.enable_offline_mode=function(){Ge(n.INFO,"enable_offline_mode, Enabling offline mode"),this.remove_consent_internal(e.features,!1),ge=!0,this.device_id="[CLY]_temp_id",ye=a.TEMPORARY_ID},this.disable_offline_mode=function(e){Ge(n.INFO,"disable_offline_mode, Disabling offline mode"),ge=!1,e&&this.device_id!==e?(this.device_id=e,ye=a.DEVELOPER_SUPPLIED,Ye("cly_id",this.device_id),Ye("cly_id_type",a.DEVELOPER_SUPPLIED),Ge(n.INFO,"disable_offline_mode, Changing id to: "+this.device_id)):(this.device_id=Fe(),this.device_id!==je("cly_id")&&(Ye("cly_id",this.device_id),Ye("cly_id_type",a.SDK_GENERATED)));var t=!1;if(M.length>0)for(var i=0;i<M.length;i++)"[CLY]_temp_id"===M[i].device_id&&(M[i].device_id=this.device_id,t=!0);t&&Ye("cly_queue",M,!0)},this.begin_session=function(e,i){if(Ge(n.INFO,"begin_session, Starting the session"),e&&Ge(n.INFO,"begin_session, Heartbeats are disabled"),i&&Ge(n.INFO,"begin_session, Session starts irrespective of session cookie"),this.check_consent(t.SESSIONS)){if(!P){this.enableOrientationTracking&&(this.report_orientation(),u(window,"resize",(function(){B.report_orientation()}))),A=_(),P=!0,X=!e;var a=je("cly_session");if(i||!ce||!a||parseInt(a)<=_()){Ge(n.INFO,"begin_session, Session started"),null===fe&&(fe=!0);var o={begin_session:1};o.metrics=JSON.stringify(Pe()),Ue(o)}Ye("cly_session",_()+60*de)}}else pe.begin_session=arguments},this.session_duration=function(e){Ge(n.INFO,"session_duration, Reporting session duration"),this.check_consent(t.SESSIONS)&&P&&(Ge(n.INFO,"session_duration, Session extended: ",e),Ue({session_duration:e}),Ce())},this.end_session=function(e,i){Ge(n.INFO,"end_session, Ending the current session"),this.check_consent(t.SESSIONS)&&P&&(e=e||_()-A,Te(),!ce||i?(Ge(n.INFO,"end_session, Session ended"),Ue({end_session:1,session_duration:e})):this.session_duration(e),P=!1)},this.change_id=function(t,i){if(Ge(n.INFO,"change_id, Changing the ID"),i&&Ge(n.INFO,"change_id, Will merge the IDs"),t&&"string"==typeof t&&0!==t.length){if(ge)return Ge(n.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),void this.disable_offline_mode(t);if(this.device_id!==t){i||(xe(),this.end_session(null,!0),j={},this.remove_consent_internal(e.features,!1));var o=this.device_id;this.device_id=t,ye=a.DEVELOPER_SUPPLIED,Ye("cly_id",this.device_id),Ye("cly_id_type",a.DEVELOPER_SUPPLIED),Ge(n.INFO,"change_id, Changing ID from:["+o+"] to ["+t+"]"),i?Ue({old_device_id:o}):this.begin_session(!X,!0),this.remote_config&&(Ye("cly_remote_configs",q={}),this.fetch_remote_config(this.remote_config))}}else Ge(n.ERROR,"change_id, The provided ID: ["+t+"] is not a valid ID")},this.add_event=function(e){Ge(n.INFO,"add_event, Adding event: ",e);var t=!1;switch(e.key){case i.NPS:case i.SURVEY:t=this.check_consent("feedback");break;case i.STAR_RATING:t=this.check_consent("star-rating");break;case i.VIEW:t=this.check_consent("views");break;case i.ORIENTATION:t=this.check_consent("users");break;case i.PUSH_ACTION:t=this.check_consent("push");break;case i.ACTION:t=this.check_consent("clicks")||this.check_consent("scroll");break;default:t=this.check_consent("events")}t&&Se(e)},this.start_event=function(e){Ge(n.INFO,"start_event, Starting timed event with key: ["+e+"]"),e=b(e,B.maxKeyLength,"start_event",Ge),j[e]?Ge(n.WARNING,"start_event, Timed event with key ["+e+"] already started"):j[e]=_()},this.end_event=function(e){Ge(n.INFO,"end_event, Ending timed event"),"string"==typeof e&&(e={key:e}),e.key?j[e.key]?(e.dur=_()-j[e.key],this.add_event(e),delete j[e.key]):Ge(n.ERROR,"end_event, Timed event with key ["+e.key+"] was not started"):Ge(n.ERROR,"end_event, Timed event must have a key property")},this.report_orientation=function(e){Ge(n.INFO,"report_orientation, Reporting orientation"),this.check_consent(t.USERS)&&Se({key:i.ORIENTATION,segmentation:{mode:e||(window.innerWidth>window.innerHeight?"landscape":"portrait")}})},this.report_conversion=function(e,t){Ge(n.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!"),this.recordDirectAttribution(e,t)},this.recordDirectAttribution=function(e,i){Ge(n.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+e+"] and the user ID: ["+i+"]"),this.check_consent(t.ATTRIBUTION)&&(e=e||je("cly_cmp_id")||"cly_organic",Ue((i=i||je("cly_cmp_uid"))?{campaign_id:e,campaign_user:i}:{campaign_id:e}))},this.user_details=function(e){Ge(n.INFO,"user_details, Trying to add user details: ",e),this.check_consent(t.USERS)&&(e.name=b(e.name,B.maxValueSize,"user_details",Ge),e.username=b(e.username,B.maxValueSize,"user_details",Ge),e.email=b(e.email,B.maxValueSize,"user_details",Ge),e.organization=b(e.organization,B.maxValueSize,"user_details",Ge),e.phone=b(e.phone,B.maxValueSize,"user_details",Ge),e.picture=b(e.picture,4096,"user_details",Ge),e.gender=b(e.gender,B.maxValueSize,"user_details",Ge),e.byear=b(e.byear,B.maxValueSize,"user_details",Ge),e.custom=k(e.custom,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"user_details",Ge),Ue({user_details:JSON.stringify(w(e,["name","username","email","organization","phone","picture","gender","byear","custom"]))}))};var Ie={},Oe=function(e,i,n){B.check_consent(t.USERS)&&(Ie[e]||(Ie[e]={}),"$push"===n||"$pull"===n||"$addToSet"===n?(Ie[e][n]||(Ie[e][n]=[]),Ie[e][n].push(i)):Ie[e][n]=i)};function Ne(){B.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(B.ignore_visitor=!0),B.ignore_bots&&I()&&(B.ignore_visitor=!0)}function xe(){H.length>0&&(Ue({events:JSON.stringify(H)}),Ye("cly_event",H=[]))}function De(e,t){if(document.getElementById("countly-feedback-sticker-"+e._id))Ge(n.ERROR,"Widget with same ID exists");else try{var i=document.createElement("div");i.className="countly-iframe-wrapper",i.id="countly-iframe-wrapper-"+e._id;var a=document.createElement("span");a.className="countly-feedback-close-icon",a.id="countly-feedback-close-icon-"+e._id,a.innerText="x";var o=document.createElement("iframe");if(o.name="countly-feedback-iframe",o.id="countly-feedback-iframe",o.src=B.url+"/feedback?widget_id="+e._id+"&app_key="+B.app_key+"&device_id="+B.device_id+"&sdk_version="+r,document.body.appendChild(i),i.appendChild(a),i.appendChild(o),u(document.getElementById("countly-feedback-close-icon-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="none",document.getElementById("cfbg").style.display="none"})),t){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.id="feedback-sticker-svg",s.setAttribute("aria-hidden","true"),s.setAttribute("data-prefix","far"),s.setAttribute("data-icon","grin"),s.setAttribute("class","svg-inline--fa fa-grin fa-w-16"),s.setAttribute("role","img"),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("viewBox","0 0 496 512");var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.id="smileyPathInStickerSvg",c.setAttribute("fill","white"),c.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");var d=document.createElement("span");d.innerText=e.trigger_button_text;var l=document.createElement("div");l.style.color=e.trigger_font_color.length<7?"#"+e.trigger_font_color:e.trigger_font_color,l.style.backgroundColor=e.trigger_bg_color.length<7?"#"+e.trigger_bg_color:e.trigger_bg_color,l.className="countly-feedback-sticker  "+e.trigger_position+"-"+e.trigger_size,l.id="countly-feedback-sticker-"+e._id,s.appendChild(c),l.appendChild(s),l.appendChild(d),document.body.appendChild(l);var g=document.getElementById("smileyPathInStickerSvg");g&&(g.style.fill=e.trigger_font_color.length<7?"#"+e.trigger_font_color:e.trigger_font_color),u(document.getElementById("countly-feedback-sticker-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}))}else document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(e){Ge(n.ERROR,"Somethings went wrong while element injecting process: "+e)}}function Ae(){var e;if(void 0!==B.onload&&B.onload.length>0){for(e=0;e<B.onload.length;e++)"function"==typeof B.onload[e]&&B.onload[e](B);B.onload=[]}}function Te(){if(Q){var e={name:Q};B.check_consent(t.VIEWS)&&Se({key:i.VIEW,dur:me?0===Z?0:_()-Z:ee,segmentation:e}),Q=null}}function Ce(){if(ce){var e=je("cly_session");(!e||parseInt(e)<=_())&&(P=!1,B.begin_session(!X)),Ye("cly_session",_()+60*de)}}function Le(e){e.app_key=B.app_key,e.device_id=B.device_id,e.sdk_name=s,e.sdk_version=r,e.t=ye,B.check_consent(t.LOCATION)?(B.country_code&&(e.country_code=B.country_code),B.city&&(e.city=B.city),null!==B.ip_address&&(e.ip_address=B.ip_address)):e.location="",e.timestamp=h();var i=new Date;e.hour=i.getHours(),e.dow=i.getDay()}function Ue(e){B.ignore_visitor?Ge(n.WARNING,"User is opt_out will ignore the request: "+e):B.app_key&&B.device_id?(Le(e),M.length>V&&M.shift(),M.push(e),Ye("cly_queue",M,!0)):Ge(n.ERROR,"app_key or device_id is missing ",B.app_key,B.device_id)}function Be(){if(Ae(),B.ignore_visitor)return ue=!1,void Ge(n.WARNING,"User opt_out, no heartbeat");ue=!0;var t=0;if(F&&void 0!==e.q&&e.q.length>0){var i,a=e.q;for(e.q=[],t=0;t<a.length;t++)if(i=a[t],Ge(n.DEBUG,"Processing queued call",i),"function"==typeof i)i();else if(Array.isArray(i)&&i.length>0){var o=B,r=0;if(e.i[i[r]]&&(o=e.i[i[r]],r++),"function"==typeof o[i[r]])o[i[r]].apply(o,i.slice(r+1));else if(0===i[r].indexOf("userData.")){var s=i[r].replace("userData.","");"function"==typeof o.userData[s]&&o.userData[s].apply(o,i.slice(r+1))}else"function"==typeof e[i[r]]&&e[i[r]].apply(e,i.slice(r+1))}}if(P&&X&&me){var c=_();c-A>oe&&(B.session_duration(c-A),A=c)}if(H.length>0){if(H.length<=re)Ue({events:JSON.stringify(H)}),H=[];else{var d=H.splice(0,re);Ue({events:JSON.stringify(d)})}Ye("cly_event",H)}if(!ge&&M.length>0&&le&&_()>te){le=!1;var l=M[0];Ge(n.DEBUG,"Processing request",l),Ye("cly_queue",M,!0),B.test_mode||We("send_request_queue",B.url+G,l,(function(e,t){Ge(n.DEBUG,"Request Finished",t,e),e?(te=_()+ie,Ge(n.ERROR,"Request error: ",e)):M.shift(),Ye("cly_queue",M,!0),le=!0}),!1)}setTimeout(Be,z)}function Fe(){var e=je("cly_id");return e?(ye=je("cly_id_type"),e):m()}function Pe(){var e=JSON.parse(JSON.stringify(B.metrics||{}));if(e._app_version=e._app_version||B.app_version,e._ua=e._ua||R(),screen.width){var t=screen.width?parseInt(screen.width):0,i=screen.height?parseInt(screen.height):0;if(0!==t&&0!==i){if(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)t=Math.round(t*window.devicePixelRatio),i=Math.round(i*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var a=t;t=i,i=a}e._resolution=e._resolution||t+"x"+i}}window.devicePixelRatio&&(e._density=e._density||window.devicePixelRatio);var o=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(void 0!==o&&(e._locale=e._locale||o),void 0!==document.referrer&&document.referrer.length){var r=c.exec(document.referrer);if(r&&r[11]&&r[11]!==window.location.hostname){var s=!1;if(Y&&Y.length)for(var d=0;d<Y.length;d++)try{if(new RegExp(Y[d]).test(document.referrer)){Ge(n.DEBUG,"Ignored: "+document.referrer),s=!0;break}}catch(e){Ge(n.ERROR,"Problem with ignoring: "+Y[d],", error: "+e)}s||(e._store=e._store||document.referrer)}}return Ge(n.DEBUG,"Got metrics",e),e}function Ge(e,t){if(B.debug&&"undefined"!=typeof console){arguments[2]&&"object"==typeof arguments[2]&&(arguments[2]=JSON.stringify(arguments[2])),F||(t="["+B.app_key+"] "+t),e||(e=n.DEBUG);for(var i="",a=2;a<arguments.length;a++)i+=arguments[a];var o=e+t+i;e===n.ERROR?console.error(o):e===n.WARNING?console.warn(o):e===n.INFO?console.info(o):e===n.VERBOSE?console.log(o):console.debug(o)}}function We(e,t,i,a,o){o=o||!1;try{Ge(n.DEBUG,"Sending XML HTTP request");var r=null;window.XMLHttpRequest?r=new window.XMLHttpRequest:window.ActiveXObject&&(r=new window.ActiveXObject("Microsoft.XMLHTTP"));var s=v(i=i||{}),c="GET";for(var d in(B.force_post||s.length>=2e3)&&(c="POST"),"GET"===c?r.open("GET",t+"?"+s,!0):(r.open("POST",t,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded")),B.headers)r.setRequestHeader(d,B.headers[d]);r.onreadystatechange=function(){4===this.readyState&&(Ge(n.DEBUG,e+" HTTP request completed ["+this.status+"]["+this.responseText+"]"),(o?Ve(this.status,this.responseText):ze(this.status,this.responseText))?"function"==typeof a&&a(!1,i,this.responseText):(Ge(n.ERROR,e+" Failed Server XML HTTP request, ",this.status),"function"==typeof a&&a(!0,i)))},"GET"===c?r.send():r.send(s)}catch(t){Ge(n.ERROR,e+" Failed XML HTTP request: "+t),"function"==typeof a&&a(!0,i)}}function ze(e,t){if(!(e>=200&&e<300))return Ge(n.ERROR,"Http response status code is not within the expected range:["+e+"]"),!1;try{var i=JSON.parse(t);return"[object Object]"!==Object.prototype.toString.call(i)?(Ge(n.ERROR,"Http response is not JSON Object"),!1):!!i.result}catch(e){return Ge(n.ERROR,"Http response is not JSON: "+e),!1}}function Ve(e,t){if(!(e>=200&&e<300))return Ge(n.ERROR,"Http response status code is not within the expected range: "+e),!1;try{var i=JSON.parse(t);return!("[object Object]"!==Object.prototype.toString.call(i)&&!Array.isArray(i)&&(Ge(n.ERROR,"Http response is not JSON Object nor JSON Array"),1))}catch(e){return Ge(n.ERROR,"Http response is not JSON: "+e),!1}}function Me(){Ee=Math.max(Ee,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}function He(){if(ve){ve=!1;var e=N(),n=x(),a=D();if(B.check_consent(t.SCROLLS)){var o={type:"scroll",y:Ee+a,width:n,height:e,view:B.getViewUrl()};o=k(o,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"processScrollView",Ge),B.track_domains&&(o.domain=window.location.hostname),Se({key:i.ACTION,segmentation:o})}}}function qe(e){Ye("cly_token",e)}function Ke(e,t,i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);var a="; expires="+n.toGMTString();document.cookie=e+"="+t+a+"; path=/"}function je(e,t,i){var a;if("none"!==B.storage)return i||(e=B.app_key+"/"+e,B.namespace&&(e=E(B.namespace)+"/"+e)),void 0===t&&(t=he),t?a=localStorage.getItem(e):"localstorage"!==B.storage&&(a=function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0,a=i.length;n<a;n++){for(var o=i[n];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}(e)),B.deserialize(a);Ge(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be retrieved")}function Ye(e,t,i,a){"none"!==B.storage?(a||(e=B.app_key+"/"+e,B.namespace&&(e=E(B.namespace)+"/"+e)),void 0===i&&(i=he),null!=t&&(t=B.serialize(t),i?localStorage.setItem(e,t):"localstorage"!==B.storage&&Ke(e,t,30))):Ge(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be stored")}function Je(e,t,i){"none"!==B.storage?(i||(e=B.app_key+"/"+e,B.namespace&&(e=E(B.namespace)+"/"+e)),void 0===t&&(t=he),t?localStorage.removeItem(e):"localstorage"!==B.storage&&Ke(e,"",-1)):Ge(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be removed")}this.userData={set:function(e,t){Ge(n.INFO,"set, Setting user's custom property value: ["+t+"] under the key: ["+e+"]"),e=b(e,B.maxKeyLength,"userData set",Ge),t=b(t,B.maxValueSize,"userData set",Ge),Ie[e]=t},unset:function(e){Ge(n.INFO,"unset, Resetting user's custom property with key: ["+e+"] "),Ie[e]=""},set_once:function(e,t){Ge(n.INFO,"set_once, Setting user's unique custom property value: ["+t+"] under the key: ["+e+"] "),e=b(e,B.maxKeyLength,"userData set_once",Ge),t=b(t,B.maxValueSize,"userData set_once",Ge),Oe(e,t,"$setOnce")},increment:function(e){Ge(n.INFO,"increment, Increasing user's custom property value under the key: ["+e+"] by one"),e=b(e,B.maxKeyLength,"userData increment",Ge),Oe(e,1,"$inc")},increment_by:function(e,t){Ge(n.INFO,"increment_by, Increasing user's custom property value under the key: ["+e+"] by: ["+t+"]"),e=b(e,B.maxKeyLength,"userData increment_by",Ge),t=b(t,B.maxValueSize,"userData increment_by",Ge),Oe(e,t,"$inc")},multiply:function(e,t){Ge(n.INFO,"multiply, Multiplying user's custom property value under the key: ["+e+"] by: ["+t+"]"),e=b(e,B.maxKeyLength,"userData multiply",Ge),t=b(t,B.maxValueSize,"userData multiply",Ge),Oe(e,t,"$mul")},max:function(e,t){Ge(n.INFO,"max, Saving user's maximum custom property value compared to the value: ["+t+"] under the key: ["+e+"]"),e=b(e,B.maxKeyLength,"userData max",Ge),t=b(t,B.maxValueSize,"userData max",Ge),Oe(e,t,"$max")},min:function(e,t){Ge(n.INFO,"min, Saving user's minimum custom property value compared to the value: ["+t+"] under the key: ["+e+"]"),e=b(e,B.maxKeyLength,"userData min",Ge),t=b(t,B.maxValueSize,"userData min",Ge),Oe(e,t,"$min")},push:function(e,t){Ge(n.INFO,"push, Pushing a value: ["+t+"] under the key: ["+e+"] to user's custom property array"),e=b(e,B.maxKeyLength,"userData push",Ge),t=b(t,B.maxValueSize,"userData push",Ge),Oe(e,t,"$push")},push_unique:function(e,t){Ge(n.INFO,"push_unique, Pushing a unique value: ["+t+"] under the key: ["+e+"] to user's custom property array"),e=b(e,B.maxKeyLength,"userData push_unique",Ge),t=b(t,B.maxValueSize,"userData push_unique",Ge),Oe(e,t,"$addToSet")},pull:function(e,t){Ge(n.INFO,"pull, Removing the value: ["+t+"] under the key: ["+e+"] from user's custom property array"),Oe(e,t,"$pull")},save:function(){Ge(n.INFO,"save, Saving changes to user's custom property"),B.check_consent(t.USERS)&&Ue({user_details:JSON.stringify({custom:Ie})}),Ie={}}},this.report_trace=function(e){if(Ge(n.INFO,"report_trace, Reporting performance trace"),this.check_consent(t.APM)){for(var i=["type","name","stz","etz","apm_metrics","apm_attr"],a=0;a<i.length;a++)if("apm_attr"!==i[a]&&void 0===e[i[a]])return void Ge(n.WARNING,"report_trace, APM trace don't have the property: "+i[a]);e.name=b(e.name,B.maxKeyLength,"report_trace",Ge),e.app_metrics=k(e.app_metrics,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"report_trace",Ge);var o=w(e,i);o.timestamp=e.stz;var r=new Date;o.hour=r.getHours(),o.dow=r.getDay(),Ue({apm:JSON.stringify(o)}),Ge(n.INFO,"report_trace, Successfully adding APM trace: ",o)}},this.track_errors=function(t){Ge(n.INFO,"track_errors, Started tracking errors"),e.i[this.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,J=t,window.onerror=function e(t,i,a,o,r){if(null!=r)y(r,!1);else{var s="";void 0!==t&&(s+=t+"\n"),void 0!==i&&(s+="at "+i),void 0!==a&&(s+=":"+a),void 0!==(o=o||window.event&&window.event.errorCharacter)&&(s+=":"+o),s+="\n";try{for(var c=[],d=e.caller;d;)c.push(d.name),d=d.caller;s+=c.join("\n")}catch(e){Ge(n.ERROR,"track_errors, Call stack generation experienced a problem: "+e)}y(s,!1)}},window.addEventListener("unhandledrejection",(function(e){y(new Error("Unhandled rejection (reason: "+(e.reason&&e.reason.stack?e.reason.stack:e.reason)+")."),!0)})))},this.log_error=function(e,t){Ge(n.INFO,"log_error, Logging errors"),this.recordError(e,!0,t)},this.add_log=function(e){if(Ge(n.INFO,"add_log, Adding a new log of breadcrumbs: [ "+e+" ]"),this.check_consent(t.CRASHES)){for(e=b(e,B.maxValueSize,"add_log",Ge);K.length>=B.maxBreadcrumbCount;)K.shift(),Ge(n.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");K.push(e)}},this.fetch_remote_config=function(e,i,a){if(Ge(n.INFO,"fetch_remote_config, Fetching remote config"),this.check_consent(t.REMOTE_CONFIG)){var o={method:"fetch_remote_config"};this.check_consent(t.SESSIONS)&&(o.metrics=JSON.stringify(Pe())),e&&(a||"function"!=typeof e?Array.isArray(e)&&e.length&&(Ge(n.INFO,"fetch_remote_config, Keys to fetch: [ "+e+" ]"),o.keys=JSON.stringify(e)):(a=e,e=null)),i&&(Ge(n.INFO,"fetch_remote_config, Keys to omit: [ "+i+" ]"),a||"function"!=typeof i?Array.isArray(i)&&i.length&&(o.omit_keys=JSON.stringify(i)):(a=i,i=null)),Le(o),We("fetch_remote_config",this.url+W,o,(function(e,t,i){if(e)Ge(n.ERROR,"fetch_remote_config, An error occurred: "+e);else{try{var r=JSON.parse(i);if(o.keys||o.omit_keys)for(var s in r)q[s]=r[s];else q=r;Ye("cly_remote_configs",q)}catch(e){Ge(n.ERROR,"fetch_remote_config, Had an issue while parsing the response: "+e)}"function"==typeof a&&(Ge(n.INFO,"fetch_remote_config, Callback function is provided"),a(e,q))}}),!0)}else Ge(n.ERROR,"fetch_remote_config, Remote config requires explicit consent"),"function"==typeof a&&a(new Error("Remote config requires explicit consent"),q)},this.get_remote_config=function(e){return Ge(n.INFO,"get_remote_config, Getting remote config"),void 0!==e?q[e]:q},this.stop_time=function(){Ge(n.INFO,"stop_time, Stopping tracking duration"),me&&(me=!1,$=_()-A,ee=0===Z?0:_()-Z)},this.start_time=function(){Ge(n.INFO,"start_time, Starting tracking duration"),me||(me=!0,A=_()-$,Z=0===Z?0:_()-ee,ee=0,Ce())},this.track_sessions=function(){Ge(n.INFO,"track_session, Starting tracking user session"),this.begin_session(),this.start_time(),u(window,"beforeunload",(function(){xe(),B.end_session()}));var e="hidden";function t(){document[e]||!document.hasFocus()?B.stop_time():B.start_time()}function i(){ae>=ne&&B.start_time(),ae=0}u(window,"focus",t),u(window,"blur",t),u(window,"pageshow",t),u(window,"pagehide",t),"onfocusin"in document&&(u(window,"focusin",t),u(window,"focusout",t)),e in document?document.addEventListener("visibilitychange",t):"mozHidden"in document?(e="mozHidden",document.addEventListener("mozvisibilitychange",t)):"webkitHidden"in document?(e="webkitHidden",document.addEventListener("webkitvisibilitychange",t)):"msHidden"in document&&(e="msHidden",document.addEventListener("msvisibilitychange",t)),u(window,"mousemove",i),u(window,"click",i),u(window,"keydown",i),u(window,"scroll",i),setInterval((function(){++ae>=ne&&B.stop_time()}),6e4)},this.track_pageview=function(e,a,o){if(Ge(n.INFO,"track_pageview, Tracking page views"),Ge(n.VERBOSE,"track_pageview, last view is:["+Q+"]"),Q&&(Ge(n.DEBUG,"track_pageview, Scroll registry triggered"),He(),ve=!0,Ee=0),Te(),(e=b(e,B.maxKeyLength,"track_pageview",Ge))&&Array.isArray(e)&&(a=e,e=null),e||(e=this.getViewName()),void 0!==e&&""!==e)if(null!==e){if(a&&a.length)for(var r=0;r<a.length;r++)try{if(new RegExp(a[r]).test(e))return void Ge(n.INFO,"track_pageview, Ignoring the page: "+e)}catch(e){Ge(n.ERROR,"track_pageview, Problem with finding ignore list item: "+a[r]+", error: "+e)}Q=e,Z=_(),Ge(n.VERBOSE,"track_pageview, last view is assigned:["+Q+"]");var s={name:e,visit:1,view:B.getViewUrl()};if(s=k(s,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"track_pageview",Ge),this.track_domains&&(s.domain=window.location.hostname),ce)if(P)fe&&(fe=!1,s.start=1);else{var d=je("cly_session");(!d||parseInt(d)<=_())&&(fe=!1,s.start=1)}else if(void 0!==document.referrer&&document.referrer.length){var l=c.exec(document.referrer);l&&l[11]&&l[11]!==window.location.hostname&&(s.start=1)}if(o)for(var u in o=k(o,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"track_pageview",Ge))void 0===s[u]&&(s[u]=o[u]);this.check_consent(t.VIEWS)?Se({key:i.VIEW,segmentation:s}):pe.track_pageview=arguments}else Ge(n.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");else Ge(n.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.")},this.track_view=function(e,t,i){Ge(n.INFO,"track_view, Initiating tracking page views"),this.track_pageview(e,t,i)},this.track_clicks=function(e){Ge(n.INFO,"track_clicks, Starting to track clicks"),e&&Ge(n.INFO,"track_clicks, Tracking the specified children:["+e+"]"),e=e||document;var a=!0;u(e,"click",(function(e){if(a){if(a=!1,O(e),void 0!==e.pageX&&void 0!==e.pageY){var n=N(),o=x();if(B.check_consent(t.CLICKS)){var r={type:"click",x:e.pageX,y:e.pageY,width:o,height:n,view:B.getViewUrl()};r=k(r,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"processClick",Ge),B.track_domains&&(r.domain=window.location.hostname),Se({key:i.ACTION,segmentation:r})}}setTimeout((function(){a=!0}),1e3)}}))},this.track_scrolls=function(e){Ge(n.INFO,"track_scrolls, Starting to track scrolls"),e&&Ge(n.INFO,"track_scrolls, Tracking the specified children"),e=e||window,ve=!0,u(e,"scroll",Me),u(e,"beforeunload",He)},this.track_links=function(e){Ge(n.INFO,"track_links, Starting to track clicks to links"),e&&Ge(n.INFO,"track_links, Tracking the specified children"),e=e||document,u(e,"click",(function(e){var i=l(g(e),"a");i&&(O(e),B.check_consent(t.CLICKS)&&Se({key:"linkClick",segmentation:{href:i.href,text:i.innerText,id:i.id,view:B.getViewUrl()}}))}))},this.track_forms=function(e,i){function a(e){return e.name||e.id||e.type||e.nodeName}Ge(n.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!e+"] Tracking hidden inputs :["+!!i+"]"),e=e||document,u(e,"submit",(function(e){var n,o=g(e),r={id:o.attributes.id&&o.attributes.id.nodeValue,name:o.attributes.name&&o.attributes.name.nodeValue,action:o.attributes.action&&o.attributes.action.nodeValue,method:o.attributes.method&&o.attributes.method.nodeValue,view:B.getViewUrl()};if(void 0!==o.elements){for(var s=0;s<o.elements.length;s++)(n=o.elements[s])&&"password"!==n.type&&-1===n.className.indexOf("cly_user_ignore")&&(void 0===r["input:"+a(n)]&&(r["input:"+a(n)]=[]),"select"===n.nodeName.toLowerCase()?void 0!==n.multiple?r["input:"+a(n)].push(p(n)):r["input:"+a(n)].push(n.options[n.selectedIndex].value):"input"===n.nodeName.toLowerCase()?void 0!==n.type?"checkbox"===n.type.toLowerCase()||"radio"===n.type.toLowerCase()?n.checked&&r["input:"+a(n)].push(n.value):("hidden"!==n.type.toLowerCase()||i)&&r["input:"+a(n)].push(n.value):r["input:"+a(n)].push(n.value):("textarea"===n.nodeName.toLowerCase()||void 0!==n.value)&&r["input:"+a(n)].push(n.value));for(var c in r)r[c]&&"function"==typeof r[c].join&&(r[c]=r[c].join(", "))}B.check_consent(t.FORMS)&&Se({key:"formSubmit",segmentation:r})}))},this.collect_from_forms=function(e,t){Ge(n.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!e+"] Submitting custom user property:["+!!t+"]"),e=e||document,u(e,"submit",(function(i){var a,o=g(i),r={},s=!1;if(void 0!==o.elements){var c,d,l={},u=e.getElementsByTagName("LABEL");for(c=0;c<u.length;c++)u[c].htmlFor&&""!==u[c].htmlFor&&(l[u[c].htmlFor]=u[c].innerText||u[c].textContent||u[c].innerHTML);for(c=0;c<o.elements.length;c++)if((a=o.elements[c])&&"password"!==a.type&&-1===a.className.indexOf("cly_user_ignore")){var m="";if("select"===a.nodeName.toLowerCase()?m=void 0!==a.multiple?p(a):a.options[a.selectedIndex].value:"input"===a.nodeName.toLowerCase()?(void 0===a.type||"checkbox"!==a.type.toLowerCase()&&"radio"!==a.type.toLowerCase()||a.checked)&&(m=a.value):("textarea"===a.nodeName.toLowerCase()||void 0!==a.value)&&(m=a.value),a.className&&-1!==a.className.indexOf("cly_user_")){var _=a.className.split(" ");for(d=0;d<_.length;d++)if(0===_[d].indexOf("cly_user_")){r[_[d].replace("cly_user_","")]=m,s=!0;break}}else a.type&&"email"===a.type.toLowerCase()||a.name&&-1!==a.name.toLowerCase().indexOf("email")||a.id&&-1!==a.id.toLowerCase().indexOf("email")||a.id&&l[a.id]&&-1!==l[a.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(m)?(r.email||(r.email=m),s=!0):a.name&&-1!==a.name.toLowerCase().indexOf("username")||a.id&&-1!==a.id.toLowerCase().indexOf("username")||a.id&&l[a.id]&&-1!==l[a.id].toLowerCase().indexOf("username")?(r.username||(r.username=m),s=!0):a.name&&(-1!==a.name.toLowerCase().indexOf("tel")||-1!==a.name.toLowerCase().indexOf("phone")||-1!==a.name.toLowerCase().indexOf("number"))||a.id&&(-1!==a.id.toLowerCase().indexOf("tel")||-1!==a.id.toLowerCase().indexOf("phone")||-1!==a.id.toLowerCase().indexOf("number"))||a.id&&l[a.id]&&(-1!==l[a.id].toLowerCase().indexOf("tel")||-1!==l[a.id].toLowerCase().indexOf("phone")||-1!==l[a.id].toLowerCase().indexOf("number"))?(r.phone||(r.phone=m),s=!0):a.name&&(-1!==a.name.toLowerCase().indexOf("org")||-1!==a.name.toLowerCase().indexOf("company"))||a.id&&(-1!==a.id.toLowerCase().indexOf("org")||-1!==a.id.toLowerCase().indexOf("company"))||a.id&&l[a.id]&&(-1!==l[a.id].toLowerCase().indexOf("org")||-1!==l[a.id].toLowerCase().indexOf("company"))?(r.organization||(r.organization=m),s=!0):(a.name&&-1!==a.name.toLowerCase().indexOf("name")||a.id&&-1!==a.id.toLowerCase().indexOf("name")||a.id&&l[a.id]&&-1!==l[a.id].toLowerCase().indexOf("name"))&&(r.name||(r.name=""),r.name+=m+" ",s=!0)}}s&&(Ge(n.INFO,"collect_from_forms, Gathered user data",r),t?B.user_details({custom:r}):B.user_details(r))}))},this.collect_from_facebook=function(e){Ge(n.INFO,"collect_from_facebook, Starting to collect possible user data"),FB&&FB.api&&FB.api("/me",(function(t){var i={};if(t.name&&(i.name=t.name),t.email&&(i.email=t.email),"male"===t.gender?i.gender="M":"female"===t.gender&&(i.gender="F"),t.birthday){var n=t.birthday.split("/").pop();n&&4===n.length&&(i.byear=n)}if(t.work&&t.work[0]&&t.work[0].employer&&t.work[0].employer.name&&(i.organization=t.work[0].employer.name),e)for(var a in i.custom={},e){for(var o=e[a].split("."),r=t,s=0;s<o.length&&void 0!==(r=r[o[s]]);s++);void 0!==r&&(i.custom[a]=r)}B.user_details(i)}))},this.opt_out=function(){Ge(n.INFO,"opt_out, Opting out the user"),this.ignore_visitor=!0,Ye("cly_ignore",!0)},this.opt_in=function(){Ge(n.INFO,"opt_in, Opting in the user"),Ye("cly_ignore",!1),this.ignore_visitor=!1,Ne(),this.ignore_visitor||ue||Be()},this.report_feedback=function(e){Ge(n.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!"),this.recordRatingWidgetWithID(e)},this.recordRatingWidgetWithID=function(e){if(Ge(n.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+e.widget_id+" ]"),this.check_consent(t.STAR_RATING))if(e.widget_id)if(e.rating){var a={key:i.STAR_RATING,count:1,segmentation:{}};a.segmentation=w(e,["widget_id","contactMe","platform","app_version","rating","email","comment"]),a.segmentation.app_version||(a.segmentation.app_version=this.metrics._app_version||this.app_version),a.segmentation.rating>5?(Ge(n.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),a.segmentation.rating=5):a.segmentation.rating<1&&(Ge(n.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),a.segmentation.rating=1),Ge(n.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",a),Se(a)}else Ge(n.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");else Ge(n.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property")},this.reportFeedbackWidgetManually=function(e,a,o){if(this.check_consent(t.FEEDBACK))if(e&&a)if(e._id)if(ge)Ge(n.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");else{Ge(n.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+e._id+" ] and type: ["+e.type+"]");var r,s=[],c=e.type;if("nps"===c){if(o){if(!o.rating)return void Ge(n.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");o.rating=Math.round(o.rating),o.rating>10?(Ge(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),o.rating=10):o.rating<0&&(Ge(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),o.rating=0),s=["rating","comment"]}r=i.NPS}else if("survey"===c){if(o){if(Object.keys(o).length<1)return void Ge(n.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");s=Object.keys(o)}r=i.SURVEY}else{if("rating"!==c)return void Ge(n.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");if(o){if(!o.rating)return void Ge(n.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");o.rating=Math.round(o.rating),o.rating>5?(Ge(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),o.rating=5):o.rating<1&&(Ge(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),o.rating=1),s=["rating","comment","email","contactMe"]}r=i.STAR_RATING}var d={key:r,count:1,segmentation:{widget_id:e._id,platform:this.platform,app_version:this.metrics._app_version||this.app_version}};null===o?d.segmentation.closed=1:d.segmentation=function(e,t,i){if(i){for(var n,a=0,o=i.length;a<o;a++)void 0!==t[n=i[a]]&&(e[n]=t[n]);return e}}(d.segmentation,o,s),Ge(n.INFO,"reportFeedbackWidgetManually, Reporting "+c+": ",d),Se(d)}else Ge(n.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");else Ge(n.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.")},this.show_feedback_popup=function(e){Ge(n.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),this.presentRatingWidgetWithID(e)},this.presentRatingWidgetWithID=function(e){Ge(n.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+e+" ]"),this.check_consent(t.STAR_RATING)&&(ge?Ge(n.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):We("presentRatingWidgetWithID",this.url+"/o/feedback/widget",{widget_id:e},(function(e,t,i){if(e)Ge(n.ERROR,"presentRatingWidgetWithID, An error occurred: "+e);else try{De(JSON.parse(i),!1)}catch(e){Ge(n.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+e)}}),!0))},this.initialize_feedback_popups=function(e){Ge(n.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),this.initializeRatingWidgets(e)},this.initializeRatingWidgets=function(e){if(Ge(n.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+e+"]"),this.check_consent(t.STAR_RATING)){e||(e=je("cly_fb_widgets"));for(var i=document.getElementsByClassName("countly-feedback-sticker");i.length>0;)i[0].remove();We("initializeRatingWidgets",this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(e)},(function(e,t,i){if(e)Ge(n.ERROR,"initializeRatingWidgets, An error occurred: "+e);else try{for(var a=JSON.parse(i),o=0;o<a.length;o++)if("true"===a[o].is_active&&a[o].target_devices[S()])if("string"==typeof a[o].hide_sticker&&(a[o].hide_sticker="true"===a[o].hide_sticker),"all"!==a[o].target_page||a[o].hide_sticker)for(var r=a[o].target_pages,s=0;s<r.length;s++){var c=r[s].substr(0,r[s].length-1)===window.location.pathname.substr(0,r[s].length-1),d=r[s]===window.location.pathname;(r[s].includes("*")&&c||d)&&!a[o].hide_sticker&&De(a[o],!0)}else De(a[o],!0)}catch(e){Ge(n.ERROR,"initializeRatingWidgets, JSON parse error: "+e)}}),!0)}},this.enable_feedback=function(e){Ge(n.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),this.enableRatingWidgets(e)},this.enableRatingWidgets=function(e){if(Ge(n.INFO,"enableRatingWidgets, Enabling rating widget with params:",e),this.check_consent(t.STAR_RATING))if(ge)Ge(n.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode");else{Ye("cly_fb_widgets",e.popups||e.widgets),C(this.url+"/star-rating/stylesheets/countly-feedback-web.css");var i=e.popups||e.widgets;i.length>0?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initializeRatingWidgets(i)):Ge(n.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")}},this.get_available_feedback_widgets=function(e){Ge(n.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!e+"]"),this.check_consent(t.FEEDBACK)?ge?Ge(n.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode."):We("get_available_feedback_widgets",this.url+W,{method:t.FEEDBACK,device_id:this.device_id,app_key:this.app_key},(function(t,i,a){if(t)return Ge(n.ERROR,"get_available_feedback_widgets, Error occurred while fetching feedbacks: "+t),void(e&&e(null,t));try{var o=JSON.parse(a).result||[];return void(e&&e(o,null))}catch(t){Ge(n.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+t),e&&e(null,t)}}),!1):e&&e(null,new Error("Consent for feedback not provided."))},this.getFeedbackWidgetData=function(e,i){if(e.type)if(Ge(n.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(e)+"], callback function is provided:["+!!i+"]"),this.check_consent(t.FEEDBACK))if(ge)Ge(n.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");else{var a=this.url,o={widget_id:e._id,shown:1,sdk_version:r,sdk_name:s,platform:this.platform,app_version:this.app_version};if("nps"===e.type)a+="/o/surveys/nps/widget";else if("survey"===e.type)a+="/o/surveys/survey/widget";else{if("rating"!==e.type)return void Ge(n.ERROR,"getFeedbackWidgetData, Unknown type info: ["+e.type+"]");a+="/o/surveys/rating/widget"}We("getFeedbackWidgetData",a,o,(function(e,t,a){if(e)return Ge(n.ERROR,"getFeedbackWidgetData, Error occurred while fetching feedbacks: "+e),void(i&&i(null,e));try{var o=JSON.parse(a);return void(i&&i(o,null))}catch(e){Ge(n.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+e),i&&i(null,e)}}),!0)}else i&&i(null,new Error("Consent for feedback not provided."));else Ge(n.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(e)+"], aborting.")},this.present_feedback_widget=function(e,i,a){if(Ge(n.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+i+" ] and className: [ "+a+" ]"),this.check_consent(t.FEEDBACK))if(e&&"object"==typeof e&&!Array.isArray(e))try{var o=this.url;if("nps"===e.type)Ge(n.DEBUG,"present_feedback_widget, Widget type: nps."),o+="/feedback/nps";else if("survey"===e.type)Ge(n.DEBUG,"present_feedback_widget, Widget type: survey."),o+="/feedback/survey";else{if("rating"!==e.type)return void Ge(n.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");Ge(n.DEBUG,"present_feedback_widget, Widget type: rating."),o+="/feedback/rating"}var c,d=window.origin||window.location.origin;"rating"===e.type?(Ge(n.DEBUG,"present_feedback_widget, Loading css for rating widget."),c="ratings",C(this.url+"/star-rating/stylesheets/countly-feedback-web.css")):(Ge(n.DEBUG,"present_feedback_widget, Loading css for survey or nps."),C(this.url+"/surveys/stylesheets/countly-surveys.css"),c="surveys"),o+="?widget_id="+e._id,o+="&app_key="+this.app_key,o+="&device_id="+this.device_id,o+="&sdk_name="+s,o+="&platform="+this.platform,o+="&app_version="+this.app_version,o+="&sdk_version="+r,o+="&origin="+d,o+="&widget_v=web";var l=document.createElement("iframe");l.src=o,l.name="countly-"+c+"-iframe",l.id="countly-"+c+"-iframe";var g=!1;l.onload=function(){g&&(document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"),g=!0,Ge(n.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var p=document.getElementById("csbg");p;)p.remove(),p=document.getElementById("csbg"),Ge(n.DEBUG,"present_feedback_widget, Removing past overlay.");for(var m=document.getElementsByClassName("countly-"+c+"-wrapper"),_=0;_<m.length;_++)m[_].remove(),Ge(n.DEBUG,"present_feedback_widget, Removed a wrapper.");(m=document.createElement("div")).className="countly-"+c+"-wrapper",m.id="countly-"+c+"-wrapper-"+e._id,"survey"===e.type&&(m.className=m.className+" "+e.appearance.position);var h=document.body,f=!1;if(i&&(document.getElementById(i)?(h=document.getElementById(i),f=!0):Ge(n.ERROR,"present_feedback_widget, Provided ID not found.")),f||a&&(document.getElementsByClassName(a)[0]?h=document.getElementsByClassName(a)[0]:Ge(n.ERROR,"present_feedback_widget, Provided class not found.")),h.insertAdjacentHTML("beforeend",'<div id="csbg"></div>'),h.appendChild(m),"rating"===e.type){var y=document.createElement("div");y.className="countly-ratings-overlay",y.id="countly-ratings-overlay-"+e._id,m.appendChild(y),Ge(n.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper"),u(document.getElementById("countly-ratings-overlay-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="none"}))}if(m.appendChild(l),Ge(n.DEBUG,"present_feedback_widget, Appended the iframe"),u(window,"message",(function(t){var i={};try{i=JSON.parse(t.data),Ge(n.DEBUG,"present_feedback_widget, Parsed response message "+i)}catch(e){Ge(n.ERROR,"present_feedback_widget, Error while parsing message body "+e)}i.close?(document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"):Ge(n.DEBUG,"present_feedback_widget, Closing signal not sent yet")})),"survey"===e.type){var v=!1;switch(e.showPolicy){case"afterPageLoad":"complete"===document.readyState?v||(v=!0,w(e)):u(document,"readystatechange",(function(t){"complete"===t.target.readyState&&(v||(v=!0,w(e)))}));break;case"afterConstantDelay":setTimeout((function(){v||(v=!0,w(e))}),1e4);break;case"onAbandon":"complete"===document.readyState?u(document,"mouseleave",(function(){v||(v=!0,w(e))})):u(document,"readystatechange",(function(t){"complete"===t.target.readyState&&u(document,"mouseleave",(function(){v||(v=!0,w(e))}))}));break;case"onScrollHalfwayDown":u(window,"scroll",(function(){v||Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)>=N()/2&&(v=!0,w(e))}));break;default:v||(v=!0,w(e))}}else if("nps"===e.type)document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="block",document.getElementById("csbg").style.display="block";else if("rating"===e.type){var E=!1;"complete"===document.readyState?E||(E=!0,k(e)):u(document,"readystatechange",(function(t){"complete"===t.target.readyState&&(E||(E=!0,k(e)))}))}}catch(e){Ge(n.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+e)}else Ge(n.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");function w(e){document.getElementById("countly-surveys-wrapper-"+e._id).style.display="block",document.getElementById("csbg").style.display="block"}function k(e){if(!e.appearance.hideS){Ge(n.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden");var t=document.createElement("div");t.innerText=e.appearance.text,t.style.color=e.appearance.text_color.length<7?"#"+e.appearance.text_color:e.appearance.text_color,t.style.backgroundColor=e.appearance.bg_color.length<7?"#"+e.appearance.bg_color:e.appearance.bg_color,t.className="countly-feedback-sticker  "+e.appearance.position+"-"+e.appearance.size,t.id="countly-feedback-sticker-"+e._id,document.body.appendChild(t),u(document.getElementById("countly-feedback-sticker-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="flex",document.getElementById("csbg").style.display="block"}))}u(document.getElementById("countly-feedback-close-icon-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"}))}},this.recordError=function(e,i,a){if(Ge(n.INFO,"recordError, Recording error"),this.check_consent(t.CRASHES)&&e){a=a||J;var o="";if("object"==typeof e?void 0!==e.stack?o=e.stack:(void 0!==e.name&&(o+=e.name+":"),void 0!==e.message&&(o+=e.message+"\n"),void 0!==e.fileName&&(o+="in "+e.fileName+"\n"),void 0!==e.lineNumber&&(o+="on "+e.lineNumber),void 0!==e.columnNumber&&(o+=":"+e.columnNumber)):o=e+"",o.length>B.maxStackTraceLineLength*B.maxStackTraceLinesPerThread){Ge(n.DEBUG,"record_error, Error stack is too long will be truncated");var r=o.split("\n");r.length>B.maxStackTraceLinesPerThread&&(r=r.splice(0,B.maxStackTraceLinesPerThread));for(var s=0,c=r.length;s<c;s++)r[s].length>B.maxStackTraceLineLength&&(r[s]=r[s].substring(0,B.maxStackTraceLineLength));o=r.join("\n")}i=!!i;var d=Pe(),l={_resolution:d._resolution,_error:o,_app_version:d._app_version,_run:_()-_e,_not_os_specific:!0,_javascript:!0},u=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;u&&(l._bat=Math.floor(100*u.level)),void 0!==navigator.onLine&&(l._online=!!navigator.onLine),l._background=!document.hasFocus(),K.length>0&&(l._logs=K.join("\n")),K=[],l._nonfatal=i,l._view=this.getViewName(),void 0!==a&&(a=k(a,B.maxKeyLength,B.maxValueSize,B.maxSegmentationValues,"record_error",Ge),l._custom=a);try{var g=document.createElement("canvas").getContext("experimental-webgl");l._opengl=g.getParameter(g.VERSION)}catch(e){Ge(n.ERROR,"Could not get the experimental-webgl context: "+e)}Ue({crash:JSON.stringify(l)})}},this.onStorageChange=function(e,t){switch(Ge(n.INFO,"onStorageChange, Applying storage changes"),e){case"cly_remote_configs":q=B.deserialize(t||"{}");break;case"cly_ignore":B.ignore_visitor=B.deserialize(t);break;case"cly_id":B.device_id=B.deserialize(t);break;case"cly_id_type":ye=B.deserialize(t)}},this._internals={store:Ye,getDocWidth:x,getDocHeight:N,getViewportHeight:D,get_page_coord:O,get_event_target:g,add_event:u,createNewObjectFromProperties:w,truncateObject:k,truncateSingleValue:b,stripTrailingSlash:E,prepareParams:v,sendXmlHttpRequest:We,isResponseValid:ze,getInternalDeviceIdType:function(){return ye},getMsTimestamp:h,getTimestamp:_,isResponseValidBroad:Ve,log:Ge,getMetrics:Pe,generateUUID:m,sendEventsForced:xe,isUUID:function(e){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(e)},getId:Fe,heartBeat:Be,toRequestQueue:Ue,reportViewDuration:Te,loadJS:T,loadCSS:C,getLastView:function(){return Q},setToken:qe,getToken:function(){var e=je("cly_token");return Je("cly_token"),e},showLoader:L,hideLoader:U,setValueInStorage:Ye,getValueFromStorage:je,removeValueFromStorage:Je,add_cly_events:Se,processScrollView:He,processScroll:Me,currentUserAgentString:R,userAgentDeviceDetection:S,userAgentSearchBotDetection:I,getRequestQueue:function(){return M},getEventQueue:function(){return H},clearQueue:function(){M=[],Ye("cly_queue",[]),H=[],Ye("cly_event",[])}},this.initialize()},e.init=function(t){var i=(t=t||{}).app_key||e.app_key;if(!e.i||!e.i[i]){var n=new e.CountlyClass(t);if(!e.i)for(var a in e.i={},n)e[a]=n[a];e.i[i]=n}return e.i[i]};var d=0,l=function(e,t){for(t=t.toUpperCase();e;){if(e.nodeName.toUpperCase()===t)return e;e=e.parentElement}},u=function(e,t,i){void 0!==e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},g=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement};return window.addEventListener("storage",(function(t){var i=(t.key+"").split("/"),n=i.pop(),a=i.pop();e.i&&e.i[a]&&e.i[a].onStorageChange(n,t.newValue)})),e.serialize=function(e){return"object"==typeof e&&(e=JSON.stringify(e)),e},e.deserialize=function(e){try{e=JSON.parse(e)}catch(e){}return e},e.getViewName=function(){return window.location.pathname},e.getViewUrl=function(){return window.location.pathname},e.getSearchQuery=function(){return window.location.search},e.DeviceIdType={DEVELOPER_SUPPLIED:a.DEVELOPER_SUPPLIED,SDK_GENERATED:a.SDK_GENERATED,TEMPORARY_ID:a.TEMPORARY_ID},e}function p(e){var t=[];if(void 0!==e.options)for(var i=0;i<e.options.length;i++)e.options[i].selected&&t.push(e.options[i].value);return t.join(", ")}function m(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))}function _(){return Math.floor((new Date).getTime()/1e3)}function h(){var e=(new Date).getTime();return d>=e?d++:d=e,d}function f(t,i,n){if(i&&Object.keys(i).length){if(void 0!==i[t])return i[t]}else if(void 0!==e[t])return e[t];return n}function y(t,i,n){for(var a in e.i)e.i[a].tracking_crashes&&e.i[a].recordError(t,i,n)}function v(e){var t=[];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")}function E(e){return"/"===e.substr(e.length-1)?e.substr(0,e.length-1):e}function w(e,t){for(var i,n={},a=0,o=t.length;a<o;a++)void 0!==e[i=t[a]]&&(n[i]=e[i]);return n}function k(e,t,i,n,a,o){var r={};if(e){if(Object.keys(e).length>n){var s={},c=0;for(var d in e)c<n&&(s[d]=e[d],c++);e=s}for(var l in e){var u=b(l,t,a,o),g=b(e[l],i,a,o);r[u]=g}}return r}function b(e,t,i,a){var o=e;return"number"==typeof e&&(e=e.toString()),"string"==typeof e&&e.length>t&&(o=e.substring(0,t),a(n.DEBUG,i+", Key: [ "+e+" ] is longer than accepted length. It will be truncated.")),o}function R(e){if(e)return e;var t=navigator.userAgent;return t||navigator.userAgentData&&(t=navigator.userAgentData.brands.map((function(e){return e.brand+":"+e.version})).join(),t+=navigator.userAgentData.mobile?" mobi ":" ",t+=navigator.userAgentData.platform),t}function S(e){var t;if(e)t=e;else{if(navigator.userAgentData.mobile)return"phone";t=R()}t=t.toLowerCase();var i="desktop";return/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(t)?i="tablet":/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(t)&&(i="phone"),i}function I(e){return/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/.test(e||R())}function O(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function N(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function x(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function D(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function A(e,t,i,n,a,o){var r,s=document.createElement(e);s.setAttribute(t,i),s.setAttribute(n,a);var c=function(){r||o(),r=!0};o&&(s.onreadystatechange=c,s.onload=c),document.getElementsByTagName("head")[0].appendChild(s)}function T(e,t){A("script","type","text/javascript","src",e,t)}function C(e,t){A("link","rel","stylesheet","href",e,t)}function L(){var t=document.getElementById("cly-loader");if(!t){var i="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=i:a.appendChild(document.createTextNode(i)),n.appendChild(a),(t=document.createElement("div")).setAttribute("id","cly-loader"),document.body.onload=function(){if(!e.showLoaderProtection)try{document.body.appendChild(t)}catch(e){}}}t.style.display="block"}function U(){e.showLoaderProtection=!0;var t=document.getElementById("cly-loader");t&&(t.style.display="none")}}(n.Countly)}.apply(t,[]),void 0===i||(e.exports=i)}},t={},function i(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}(36);var e,t})();window.isInitialLoading=!0,window.Countly=s;try{window._exp_bc_=new BroadcastChannel("experro_com_channel")}catch(e){window._exp_bc_=null}let c=!1;const d=({templates:i,components:n,routes:r,headerComponent:d,footerComponent:l,pencilBannerComponent:u})=>{window.__EXP_STORE_INFO__&&(c||e.CommonUtilities.isRenderingOnServer()||(p(window.__EXP_STORE_INFO__.tenantId,window.__EXP_STORE_INFO__.workspaceId,window.__EXP_STORE_INFO__.environmentId),c=!0));const g="shopify"!==process.env.REACT_APP_STORE?.toLowerCase();return t.useEffect((()=>{(async()=>{try{const t=await e.AuthService.checkSessionInfo();if("true"===process.env.REACT_APP_ECOMMERCE_MODULE_ENABLE){window._exp_bc_&&window._exp_bc_.addEventListener("message",(t=>{if(t.data&&"USER_UPDATED"===t.data.event){const n=e.AuthService.getUserDetails();n.userInfo||(n.userInfo={}),t.data.data.userInfo&&t.data.data.userInfo.email&&n.userInfo.email!=t.data.data.userInfo.email&&document.dispatchEvent(new CustomEvent("LOGIN_SUCCESSFUL",{detail:t.data.data})),i()}}));const i=async()=>{const i=[],n=e.EcommerceService.getCart();if(i.push(n),g&&"true"===process.env.REACT_APP_MULTI_CURRENCY_ENABLE){const t=e.EcommerceService.getCurrencies();i.push(t)}Promise.all(i).then((i=>{const n=i[0];if(n&&"failure"!==n?.Status&&(t.userCartObj=n,e.AuthService.setUserDetails(t,!0),document.dispatchEvent(new Event("CART_REFRESH"))),i[1]&&g){const n=i[1];if(n?.length){t.currencyObj=n;const i=n.find((e=>e.is_default))||n[0];if(i&&!localStorage.getItem("_c_d"))localStorage.setItem("_c_d",JSON.stringify(i)),t.defaultCurrency=i;else{const e=localStorage.getItem("_c_d");e&&(t.defaultCurrency=JSON.parse(e))}e.AuthService.setUserDetails(t,!0),document.dispatchEvent(new CustomEvent("CURRENCY_UPDATE",{detail:{storefront:!0}}))}}})).catch((e=>{console.error(e)}))};i()}const i={storeHash:t.storeHash,environmentType:t.environmentType,workspaceId:t.workspaceId,tenantId:t.tenantId,environmentId:t.environmentId,cacheDomain:t.cacheDomain};e.CommonUtilities.isRenderingOnServer()?e.$("head").append(`<script>window['__EXP_STORE_INFO__'] = ${JSON.stringify(i)};<\/script>`):window.__EXP_STORE_INFO__=i,e.AuthService.setUserDetails(t),t&&t.userInfo&&t.userInfo.email&&document.dispatchEvent(new Event("LOGIN_SUCCESSFUL")),c||e.CommonUtilities.isRenderingOnServer()||p(i.tenantId,i.workspaceId,i.environmentId),t.userInfo.email&&e.AnalyticsService.updateUserDetails(t.userInfo),e.AuthService.forceLogout(),e.$(document).trigger("PING_COMPLETED")}catch(t){console.error(t),e.AuthService.setUserDetails({}),e.$(document).trigger("PING_COMPLETED")}})()}),[]),(({templates:t,components:i,routes:n,headerComponent:r,footerComponent:s,pencilBannerComponent:c})=>{const d=n.map((({path:t,element:i},n)=>a.default.createElement(e.Route,{path:t,element:i,key:n}))),l=n.map((({path:t,element:i},n)=>a.default.createElement(e.Route,{path:"/_ssr_"+t,element:i,key:n})));return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{suppressHydrationWarning:!0},a.default.createElement(e.Ie,null)),a.default.createElement(e.BrowserRouter,null,a.default.createElement("div",{className:"header-main"},c&&a.default.createElement(e.PencilBanner,{pencilBanner:c}),a.default.createElement(e.Header,{headerComponent:r})),c&&a.default.createElement("div",{id:"header-placeholder",className:"header-sticky-placeholder"}),a.default.createElement("main",{className:"_exp_page_main_container_ main_page_body",id:"_exp_page_main_container_",suppressHydrationWarning:!0},a.default.createElement(e.Routes,null,d,l,a.default.createElement(e.Route,{path:"/"},a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug/:pageslug1",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug/:pageslug1/:pageslug2",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug/:pageslug1/:pageslug2/:pageslug3",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug/:pageslug1/:pageslug2/:pageslug3/:pageslug4",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!1,key:Date.now(),path:":pageslug/:pageslug1/:pageslug2/:pageslug3/:pageslug4/:pageslug5",element:a.default.createElement(o,{templates:t,components:i})}),a.default.createElement(e.Route,{index:!0,key:"homepage",element:a.default.createElement(e.Page,{templates:t,components:i})})))),a.default.createElement(e.Footer,{footerComponent:s})))})({templates:i,components:n,routes:r,headerComponent:d,footerComponent:l,pencilBannerComponent:u});function p(e,t,i){"localhost"!==window.location.hostname&&(s.enable_orientation_tracking=!1,s.getViewName=function(){return document.title},s.q.push(["track_sessions"]),s.init({app_key:"k",url:"/analytics-service/v1",use_session_cookie:!0,debug:!1,require_consent:!1,offline_mode:!1,enable_orientation_tracking:!1,headers:{"x-tenant-id":e,"x-workspace-id":t,"x-env-id":i},force_post:!0}),s.q.push(["track_links"]))}};const l="app"===process.env.REACT_APP_BUILD_TARGET||!process.env.REACT_APP_BUILD_TARGET;exports.AnalyticsService=e.AnalyticsService,exports.AuthService=e.AuthService,exports.BigcommerceService=e.BigcommerceService,exports.CommonUtilities=e.CommonUtilities,exports.ContentService=e.ContentService,exports.DraggableArea=e.DraggableArea,exports.EcommerceService=e.EcommerceService,exports.Http=e.Http,exports.Link=e.Link,exports.Navigate=e.Navigate,exports.Page=e.Page,exports.Route=e.Route,exports.Router=e.BrowserRouter,exports.Switch=e.Routes,exports.UserContext=e.UserContext,exports.Widget=e.Widget,exports.toast=e._t,exports.useNavigate=e.useNavigate,exports.useParams=e.useParams,exports.useSearchParams=e.useSearchParams,exports.App=function({templates:t,components:n,singleDataModelsToPrefetch:o,routes:r,headerComponent:s,footerComponent:c,pencilBannerComponent:l}){const u=document.getElementById("root");if(u){const g=a.default.createElement("div",null,a.default.createElement(e.UserProvider,null,a.default.createElement(d,{templates:t,widgets:{},components:n,routes:r,singleDataModelsToPrefetch:o,headerComponent:s,footerComponent:c,pencilBannerComponent:l})));if(u.hasChildNodes())i.hydrateRoot(u,g);else{i.createRoot(u).render(g)}}},exports.IsCMSApp=l;
